<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <title>ei1333's page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="../css/static.css">
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
    </script>
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <header>
      <h1>ei1333's page</h1>
      <div class="path">
	<a href="../index.html">ホーム</a> &gt;
	<a href="index.html">Wiki</a>
      </div>
    </header>
    <main>
      <section>
	<h2>BIT(Binary-Indexed-Tree)</h2>
	
	<h4>説明</h4>
	<p>Fenwick Tree とも呼ばれる。数列に対し, ある要素に値を加える操作と, 区間和を求める操作をそれぞれ対数時間で行うことが出来るデータ構造。セグメント木や平衡二分探索木に比べ実装が非常に単純で, 定数倍も軽い。</p>

        <h4>使い方</h4>
        <ul>
          <li>sum(k): 区間 $[0, k]$ の合計を求める(閉区間なので注意)</li>
          <li>add(k): 要素 $k$ に値 $x$ を加える</li>
        </ul>

	<h4>計算量</h4>
	<p>$O(\log N)$</p>

	<h4>実装例</h4>
	<pre><code class="cpp">template&lt; class T &gt;
struct BinaryIndexedTree
{
  vector&lt; T &gt; data;

  BinaryIndexedTree(int sz)
  {
    data.assign(++sz, 0);
  }

  T sum(int k)
  {
    T ret = 0;
    for(++k; k &gt; 0; k -= k &amp; -k) ret += data[k];
    return (ret);
  }

  void add(int k, T x)
  {
    for(++k; k &lt; data.size(); k += k &amp; -k) data[k] += x;
  }
};</code></pre>
        <h4>問題例</h4>
        <ul>
          <li><span class="verified">検証済</span><a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=DSL_2_B&lang=jp">AOJ DSL_2_B Range SUM Query (RSQ)</a></li>
        </ul>

        <h4>応用</h4>
        <p>
          $\sum_{i=0}^{k} a_k \ge w$ となる最小の $k$ を求めたい(std::lower_bound()のイメージ)とき, BIT上を二分探索することで $O(\log N)$ 時間で行うことができる。
        </p>
      
        <pre><code class="cpp">template&lt; class T &gt;
struct AdditionalBIT : BinaryIndexedTree&lt; T &gt;
{
  int curr;

  AdditionalBIT(int sz) : BinaryIndexedTree&lt; T &gt;(sz)
  {
    curr = 1;
    while(curr &lt;= sz) curr &lt;&lt;= 1;
  }

  int lower_bound(T w)
  {
    if(w &lt;= 0) return (0);
    int i = 0;
    for(int k = curr; k &gt; 0; k &gt;&gt;= 1) {
      if(i + k &lt; BinaryIndexedTree&lt; T &gt;::data.size() &amp;&amp; BinaryIndexedTree&lt; T &gt;::data[i + k] &lt; w) {
        w -= BinaryIndexedTree&lt; T &gt;::data[i + k];
        i += k;
      }
    }
    return (i);
  }
};</code></pre>

        <h4>参考資料</h4>
        <ul>
          <li><a href="http://hos.ac/slides/20140319_bit.pdf">Binary Indexed Tree のはなし - hos.ac</a></li>
        </ul>
      </section>
    </main>
    <hr>
    <footer>
      <small>Copyright&copy; ei1333's page All Rights Reserved.</small>
    </footer>

  </body>
</html>
