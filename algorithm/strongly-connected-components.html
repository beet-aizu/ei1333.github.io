<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <title>ei1333's page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="../css/static.css">
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
    </script>
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <header>
      <h1>ei1333's page</h1>
      <div class="path">
	<a href="../index.html">ホーム</a> &gt;
	<a href="index.html">Wiki</a>
      </div>
    </header>
    <main>
      <section>
	<h2>強連結成分分解(Strongly-Connected-Components)</h2>
	
	<h4>説明</h4>
	<p>強連結成分分解する。</p>

	<h4>計算量</h4>
	<p>$O(V + E)$</p>

	<h4>実装例</h4>
	<pre><code class="cpp">struct StronglyConnectedComponents
{
  vector&lt; vector&lt; int &gt; &gt; gg, rg;
  vector&lt; pair&lt; int, int &gt; &gt; edges;
  vector&lt; int &gt; comp, order, used;

  StronglyConnectedComponents(size_t v) : gg(v), rg(v), comp(v, -1), used(v, 0) {}

  void add_edge(int x, int y)
  {
    gg[x].push_back(y);
    rg[y].push_back(x);
    edges.emplace_back(x, y);
  }

  int operator[](int k)
  {
    return (comp[k]);
  }

  void dfs(int idx)
  {
    if(used[idx]) return;
    used[idx] = true;
    for(int to : gg[idx]) dfs(to);
    order.push_back(idx);
  }

  void rdfs(int idx, int cnt)
  {
    if(comp[idx] != -1) return;
    comp[idx] = cnt;
    for(int to : rg[idx]) rdfs(to, cnt);
  }

  void build(vector&lt; vector&lt; int &gt; &gt; &amp;t)
  {
    for(int i = 0; i &lt; gg.size(); i++) dfs(i);
    reverse(begin(order), end(order));
    int ptr = 0;
    for(int i : order) if(comp[i] == -1) rdfs(i, ptr), ptr++;

    t.resize(ptr);
    set&lt; pair&lt; int, int &gt; &gt; connect;
    for(auto &amp;e : edges) {
      int x = comp[e.first], y = comp[e.second];
      if(x == y) continue;
      if(connect.count({x, y})) continue;
      t[x].push_back(y);
      connect.emplace(x, y);
    }
  }
};</code></pre>
        <h4>応用: 2-SAT</h4>
        <p>SAT(充足可能性問題) とは, 論理式が与えられたときにその論理変数に適切な真偽値を割り振ることによって, 全体の真偽値を真とすることができるか判定する問題である。</p>
        <p>次のような形の論理式を乗法標準形とよぶ。</p>
        <p>$(a \lor b \lor \dots) \land (c \lor d \lor \dots) \land \dots$</p>
        <p>$a, b, \dots$ はリテラルといい, 論理変数かその否定である。また $(a \lor b \lor \dots)$ のように $\lor$ でつながれた部分をクロージャといい, 特にクロージャ内のリテラル数が高々 $2$ であるような乗法標準形の論理式に対する SAT を 2-SAT とよぶ。</p>
        <p>クロージャ ($a \lor b)$ を $\Rightarrow$ (含意) を用いて $(\lnot a \Rightarrow b \land \lnot b \Rightarrow a)$ に変換する。すると乗法標準形は $(a \Rightarrow b) \land (c \Rightarrow d) \land \dots$ のようにすべて $\land$ で結ばれた論理式に表すことができる。ここで $x$ と $\lnot x$ に対応する頂点をつくって, $\Rightarrow$ を辺とした有向グラフを作成する。このグラフを強連結成分分解して $x$ と $\lnot x$ が同じ強連結成分に含まれるものが存在するとき充足不能, 逆に存在しないときは $x$ の強連結成分のトポロジカル順序が $\lnot x$ を含む強連結成分より後ろかどうかを真偽値として充足可能となる解を求めることが出来る。</p>

        <p>変形例として主なものを以下にあげる。</p>

        <ul>
          <li>$x$ → $(x \Rightarrow \lnot x)$</li>
          <li>$\lnot x$ → $(\lnot x \Rightarrow x)$</li>
          <li>$\lnot (x \land y)$ → $(\lnot x \lor \lnot y)$ → $(x \Rightarrow \lnot y) \land (y \Rightarrow \lnot x)$

        </ul>

     	  <h4>問題例</h4>
        <ul>
          <li><span class="verified">検証済</span><a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=GRL_3_C&lang=jp">AOJ GRL_3_C Strongly Connected Components</a></li>
        </ul>
      </section>
    </main>
    <hr>
    <footer>
      <small>Copyright&copy; ei1333's page All Rights Reserved.</small>
    </footer>

  </body>
</html>
